###############################################################################
# SARIBLOG - Tests API REST Client
# Place ce fichier dans : backend/tests/api.http
###############################################################################

### Variables globales
@baseUrl = http://localhost:4242/api

###############################################################################
# üè† TEST SERVEUR
###############################################################################

### V√©rifier que le serveur tourne
GET http://localhost:4242/

###############################################################################
# üì∞ ARTICLES (7 endpoints)
###############################################################################

### 1. Liste TOUS les articles (admin - tous statuts)
GET {{baseUrl}}/articles

### 2. Article par ID (admin - tous statuts)
GET {{baseUrl}}/articles/1

### 3. Article par SLUG (admin - tous statuts)
GET {{baseUrl}}/articles/slug/decouvrir-aquarelle-guide-debutants

### 4. Liste articles PUBLI√âS uniquement (public)
GET {{baseUrl}}/articles/published

### 5. Liste articles PUBLI√âS avec limite (public - max 20)
GET {{baseUrl}}/articles/published?limit=4

### 6. Article publi√© par SLUG (public)
GET {{baseUrl}}/articles/published/tutoriel-peindre-dragon

### 7. Preview homepage (4 derniers articles publi√©s)
GET {{baseUrl}}/articles/homepage-preview

###############################################################################
# üñºÔ∏è IMAGES (5 endpoints)
###############################################################################

### 1. Image du jour
GET {{baseUrl}}/images/image-of-the-day

### 2. Images de la GALERIE (is_in_gallery = TRUE)
GET {{baseUrl}}/images/gallery

### 3. Image par ID
GET {{baseUrl}}/images/1

### 4. Images d'un ARTICLE sp√©cifique
GET {{baseUrl}}/images/article/1

### 5. Images par TAG
GET {{baseUrl}}/images/tag/1

###############################################################################
# üë• USERS (3 endpoints)
###############################################################################

### 1. Liste tous les utilisateurs
GET {{baseUrl}}/users

### 2. Artiste principale
GET {{baseUrl}}/users/artist

### 3. Utilisateur par ID
GET {{baseUrl}}/users/1

###############################################################################
# üè∑Ô∏è TAGS (3 endpoints)
###############################################################################

### 1. Liste tous les tags
GET {{baseUrl}}/tags

### 2. Tags d'un article
GET {{baseUrl}}/tags/article/1

### 3. Tags d'une image
GET {{baseUrl}}/tags/image/1

###############################################################################
# üí¨ COMMENTS (1 endpoint)
###############################################################################

### 1. Commentaires approuv√©s d'un article
GET {{baseUrl}}/comments/article/1

###############################################################################
# üìß MESSAGES (8 endpoints)
###############################################################################

### 1. Cr√©er un message de contact (POST - public)
POST {{baseUrl}}/messages
Content-Type: application/json

{
  "firstname": "John",
  "lastname": "Doe",
  "email": "john@example.com",
  "subject": "Question sur votre art",
  "text": "Bonjour, j'aimerais en savoir plus sur vos techniques..."
}

### 2. Liste tous les messages (GET - admin)
GET {{baseUrl}}/messages

### 3. Messages par statut : non lus (GET - admin)
GET {{baseUrl}}/messages/status/unread

### 4. Messages par statut : lus (GET - admin)
GET {{baseUrl}}/messages/status/read

### 5. Messages par statut : archiv√©s (GET - admin)
GET {{baseUrl}}/messages/status/archived

### 6. Message par ID (GET - admin)
GET {{baseUrl}}/messages/1

### 7. Mettre √† jour le statut d'un message (PATCH - admin)
PATCH {{baseUrl}}/messages/1/status
Content-Type: application/json

{
  "status": "read"
}

### 8. Supprimer un message (DELETE - admin)
DELETE {{baseUrl}}/messages/1

###############################################################################
# üß™ TESTS D'ERREURS
###############################################################################

### Article inexistant (devrait retourner 404)
GET {{baseUrl}}/articles/99999

### Slug inexistant (devrait retourner 404)
GET {{baseUrl}}/articles/slug/article-qui-nexiste-pas

### Article publi√© avec slug inexistant (devrait retourner 404)
GET {{baseUrl}}/articles/published/article-qui-nexiste-pas

### Articles publi√©s avec limite invalide (devrait retourner 400)
GET {{baseUrl}}/articles/published?limit=25

### Articles publi√©s avec limite n√©gative (devrait retourner 400)
GET {{baseUrl}}/articles/published?limit=-1

### Image inexistante (devrait retourner 404)
GET {{baseUrl}}/images/99999

### Article inexistant pour images (devrait retourner tableau vide)
GET {{baseUrl}}/images/article/99999

### Tag inexistant pour images (devrait retourner tableau vide)
GET {{baseUrl}}/images/tag/99999

### User inexistant (devrait retourner 404)
GET {{baseUrl}}/users/99999

### Article inexistant pour tags (devrait retourner tableau vide)
GET {{baseUrl}}/tags/article/99999

### Image inexistante pour tags (devrait retourner tableau vide)
GET {{baseUrl}}/tags/image/99999

### Article inexistant pour commentaires (devrait retourner tableau vide)
GET {{baseUrl}}/comments/article/99999

### Message inexistant (devrait retourner 404)
GET {{baseUrl}}/messages/99999

### Message avec statut invalide (devrait retourner 400)
GET {{baseUrl}}/messages/status/invalid

### Mettre √† jour message avec statut invalide (devrait retourner 400)
PATCH {{baseUrl}}/messages/1/status
Content-Type: application/json

{
  "status": "invalid"
}

### Cr√©er message avec champs manquants (devrait retourner 400)
POST {{baseUrl}}/messages
Content-Type: application/json

{
  "firstname": "John"
}

###############################################################################
# üìù NOTES D'UTILISATION
###############################################################################
# 
# 1. Assure-toi que ton serveur tourne (npm run dev dans backend/)
# 2. Clique sur "Send Request" au-dessus de chaque requ√™te
# 3. Le r√©sultat s'affiche dans un panneau √† droite
# 4. V√©rifie les status codes :
#    - 200 = OK
#    - 201 = Created (POST r√©ussi)
#    - 204 = No Content (DELETE r√©ussi)
#    - 400 = Bad Request (erreur de validation)
#    - 404 = Not Found
#    - 500 = Erreur serveur
#
# 5. Slugs d'articles disponibles pour tester :
#    - decouvrir-aquarelle-guide-debutants
#    - processus-creatif-esquisse-illustration
#    - techniques-portrait-emotion
#    - paysages-fantastiques-numerique
#    - tutoriel-peindre-dragon
#    - palette-couleurs-fantasy
#    - astuces-ameliorer-croquis
#    - projet-personnel-portraits-fantasy
#    - art-portrait-numerique-techniques
#
# 6. Param√®tres pour les endpoints :
#    - GET /articles/published?limit=X : limite optionnelle (max 20)
#    - GET /messages/status/:status : statuts possibles = unread, read, archived
#    - PATCH /messages/:id/status : body doit contenir {"status": "unread|read|archived"}
#    - POST /messages : body doit contenir firstname, lastname, email, subject, text
#
# 7. Endpoints publics vs admin :
#    - Public : articles/published, images, users, tags, comments, POST /messages
#    - Admin : articles (tous), messages (GET/PATCH/DELETE)
#    Note : L'authentification n'est pas encore impl√©ment√©e, tous les endpoints
#           sont actuellement accessibles sans authentification.
#
###############################################################################